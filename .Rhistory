# Load required packages
library(sf)
library(tidyverse)
library(tigris)
library(tidycensus)
library(scales)
library(patchwork)
library(here)
library(sf)
library(tidyverse)
library(tigris)
library(tidycensus)
library(scales)
library(patchwork)
library(here)
install.packages("here")
# Load required packages
library(sf)
library(tidyverse)
library(tigris)
library(tidycensus)
library(scales)
library(patchwork)
library(here)
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
# Check that all data loaded correctly
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
pa_hospitals <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_Hospitals.shp")
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
pa_tracts <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore
/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_Census_Tracts.shp")
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
districts <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/districts.geojson")
hospitals <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/data/hospitals.geojson")
# Check that all data loaded correctly
pa_countiewws <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
pa_countiesdbf <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
districts <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/districts.geojson")
hospitals <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/data/hospitals.geojson")
state_bounds <- st_read("https://gis.penndot.pa.gov/gis/rest/services/opendata/stateboundary/MapServer/0/query?outFields=*&where=1%3D1&f=geojson")
pa_countiesdbf <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
pa_countiesprj <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.prj")
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
districts <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/districts.geojson")
hospitals <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/data/hospitals.geojson")
state_bounds <- st_read("https://gis.penndot.pa.gov/gis/rest/services/opendata/stateboundary/MapServer/0/query?outFields=*&where=1%3D1&f=geojson")
pa_countiesdbf <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
pa_countiesprj <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.prj")
# Load spatial data
pa_counties <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.shp")
districts <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/districts.geojson")
hospitals <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/data/hospitals.geojson")
state_bounds <- st_read("https://gis.penndot.pa.gov/gis/rest/services/opendata/stateboundary/MapServer/0/query?outFields=*&where=1%3D1&f=geojson")
pa_countiesdbf <- st_read("D:/Ph.D/US Pakistan Knowledge Corridore/Upenn/Subjects/Public Policy Analytics/Week 4/Data/Pennsylvania_County_Boundaries.dbf")
# Check that all data loaded correctly
View(hospitals)
plot(hospitals)
ggplot(hospitals)
View(census_tracts)
# Using the tigris package
# tigris returns census geometries but none of the demographic data
census_tracts <- tracts(state = "PA", cb = TRUE)
View(census_tracts)
View(census_tracts)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001"
),
state = "PA",
year = 2022,
output = "wide"
)
# Join to tract boundaries
View(tract_demographics)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001"
male_65_70 = "B01001_020"
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001"
male_S_S = "B01001_020"
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_S_S = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
View(tract_demographics)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_S_S = "B01001_020" + "B01001_021" + "B01001_022" + "B01001_023" + "B01001_024" + "B01001_025"
),
state = "PA",
year = 2022,
output = "wide"
)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_S_S = ("B01001_020" + "B01001_021" + "B01001_022" + "B01001_023" + "B01001_024" + "B01001_025")
),
state = "PA",
year = 2022,
output = "wide"
)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_S_70 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_70 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020", male_67_69 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
View(tract_demographics)
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_67_69 + male_67_69)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020", male_67_69 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_67_69 + male_67_69)
View(tract_demographics)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020", male_67_69 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
# Sum the columns
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_67_69 + male_67_69)
View(tract_demographics)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020",
male_67_69 = "B01001_020"
),
state = "PA",
year = 2022,
output = "wide"
)
# Sum the columns
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_67_69 + male_67_69)
View(tract_demographics)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020", male_67_69 = "B01001_021"
),
state = "PA",
year = 2022,
output = "wide"
)
View(tract_demographics)
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_67_69 + male_67_69)
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_65_66 + male_67_69)
# Get demographic data from ACS
tract_demographics <- get_acs(
geography = "tract",
variables = c(
total_pop = "B01003_001",
median_income = "B19013_001",
male_65_66 = "B01001_020", male_67_69 = "B01001_021"
),
state = "PA",
year = 2022,
output = "wide"
)
tract_demographics <- tract_demographics %>%
mutate(Population_65_over = male_65_66E + male_67_69E)
View(tract_demographics)
tracts_with_data <- census_tracts %>%
left_join(tract_demographics, by = "GEOID")
plot(tracts_with_data)
plot(tracts_with_data)
View(tracts_with_data)
